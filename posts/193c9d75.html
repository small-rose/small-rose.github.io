<!-- build time:Sat Jan 02 2021 23:17:58 GMT+0800 (中国标准时间) --><!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="keywords" content="Memcache,Memcache配置"><meta name="description" content="Small-Rose,张小菜苔,个人技术笔记,记录学习/开发问题"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><title>Memcache 快速上手 | 斯莫笔记</title><link rel="icon" type="image/x-icon, image/vnd.microsoft.icon" href="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/favicon.ico"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/awesome/css/all.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/materialize/materialize.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/aos/aos.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/lightGallery/css/lightgallery.min.css"><script type="text/javascript" src="/libs/artitalk/artitalk.min.css"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/css/matery.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/css/my.css"><script src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/jquery/jquery.min.js"></script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="斯莫笔记" type="application/atom+xml"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head><style type="text/css" lang="css">#loading-container{position:fixed;top:0;left:0;min-height:100vh;width:100vw;z-index:9999;display:flex;flex-direction:column;justify-content:center;align-items:center;background:#FFF;background-color:#cce8cf;text-align:center;-webkit-transition:opacity 1s ease;-moz-transition:opacity 1s ease;-o-transition:opacity 1s ease;transition:opacity 1s ease}.loading-image{width:120px;height:50px;transform:translate(-50%)}.loading-image div:nth-child(2){-webkit-animation:pacman-balls 1s linear 0s infinite;animation:pacman-balls 1s linear 0s infinite}.loading-image div:nth-child(3){-webkit-animation:pacman-balls 1s linear .33s infinite;animation:pacman-balls 1s linear .33s infinite}.loading-image div:nth-child(4){-webkit-animation:pacman-balls 1s linear .66s infinite;animation:pacman-balls 1s linear .66s infinite}.loading-image div:nth-child(5){-webkit-animation:pacman-balls 1s linear .99s infinite;animation:pacman-balls 1s linear .99s infinite}.loading-image div:first-of-type{width:0;height:0;border:25px solid #49b1f5;border-right-color:transparent;border-radius:25px;-webkit-animation:rotate_pacman_half_up .5s 0s infinite;animation:rotate_pacman_half_up .5s 0s infinite}.loading-image div:nth-child(2){width:0;height:0;border:25px solid #49b1f5;border-right-color:transparent;border-radius:25px;-webkit-animation:rotate_pacman_half_down .5s 0s infinite;animation:rotate_pacman_half_down .5s 0s infinite;margin-top:-50px}@-webkit-keyframes rotate_pacman_half_up{0%{transform:rotate(270deg)}50%{transform:rotate(1turn)}to{transform:rotate(270deg)}}@keyframes rotate_pacman_half_up{0%{transform:rotate(270deg)}50%{transform:rotate(1turn)}to{transform:rotate(270deg)}}@-webkit-keyframes rotate_pacman_half_down{0%{transform:rotate(90deg)}50%{transform:rotate(0)}to{transform:rotate(90deg)}}@keyframes rotate_pacman_half_down{0%{transform:rotate(90deg)}50%{transform:rotate(0)}to{transform:rotate(90deg)}}@-webkit-keyframes pacman-balls{75%{opacity:.7}to{transform:translate(-100px,-6.25px)}}@keyframes pacman-balls{75%{opacity:.7}to{transform:translate(-100px,-6.25px)}}.loading-image div:nth-child(3),.loading-image div:nth-child(4),.loading-image div:nth-child(5),.loading-image div:nth-child(6){background-color:#49b1f5;width:15px;height:15px;border-radius:100%;margin:2px;width:10px;height:10px;position:absolute;transform:translateY(-6.25px);top:25px;left:100px}.loading-text{margin-bottom:20vh;text-align:center;color:#2c3e50;font-size:2rem;box-sizing:border-box;padding:0 10px;text-shadow:0 2px 10px rgba(0,0,0,.2)}@media only screen and (max-width:500px){.loading-text{font-size:1.5rem}}.fadeout{opacity:0;filter:alpha(opacity=0)}@-webkit-keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}100%{opacity:1;-webkit-transform:none;transform:none}}@keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0)}}</style><script>!function(){const n=function(){setTimeout(function(){const n=document.getElementById("loading-container");n.className="fadeout",setTimeout(function(){n.style.display="none"},2500)},1e3)};n()}()</script><body><div id="loading-container"><p class="loading-text">嘘~ 正在从服务器偷取页面 . . .</p><div class="loading-image"><div></div><div></div><div></div><div></div><div></div></div></div><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><img src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/medias/logo-3.png" class="logo-img" alt="LOGO"> <span class="logo-span mytitle">斯莫笔记</span></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home"></i><span>主</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fas fa-tags"></i><span>签</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fas fa-bookmark"></i><span>类</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fas fa-archive"></i><span>档</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/about" class="waves-effect waves-light"><i class="fas fa-user-circle"></i><span>吾</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fas fa-comments"></i><span>言</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/artitalk" class="waves-effect waves-light"><i class="fas fa-heartbeat"></i><span>语</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fas fa-address-book"></i><span>友</span></a></li><li class="hide-on-med-and-down nav-item"><a href="https://travellings.now.sh/" target="_blank" rel="noopener" class="waves-effect waves-light"><i class="fas fa-location-arrow"></i><span>开</span></a></li><li class="hide-on-med-and-down nav-item"><a href="http://chat.zhangxiaocai.cn/" target="_blank" rel="noopener" class="waves-effect waves-light"><i class="fas fa fa-comment-alt"></i><span>问</span></a></li><li class="hide-on-med-and-down nav-item"><a href="" class="waves-effect waves-light"><i class="fas fa-list"></i> <span>秘</span> <i class="fas fa-chevron-down" aria-hidden="true"></i></a><ul class="sub-nav menus_item_child"><li><a href="/navigate"><i class="fas fa-location-arrow" style="margin-top:-20px"></i> <span>风域之门</span></a></li><li><a href="/box"><i class="fas fa-map-marker" style="margin-top:-20px"></i> <span>妖魔化镜</span></a></li><li><a href="https://blog.zhangxiaocai.cn" target="_blank" rel="noopener"><i class="fas fa-pen-alt" style="margin-top:-20px"></i> <span>阿蓝故事</span></a></li><li><a href="https://hut.zhangxiaocai.cn" target="_blank" rel="noopener"><i class="fas fa-pen-alt" style="margin-top:-20px"></i> <span>记忆成风</span></a></li><li><a href="https://yun.zhangxiaocai.cn" target="_blank" rel="noopener"><i class="fas fa-cloud" style="margin-top:-20px"></i> <span>云上之城</span></a></li><li><a href="/color"><i class="fas fa-asterisk" style="margin-top:-20px"></i> <span>红飞翠舞</span></a></li><li><a href="https://status.zhangxiaocai.cn/" target="_blank" rel="noopener"><i class="fa fa-yin-yang" style="margin-top:-20px"></i> <span>沧海成渊</span></a></li></ul></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fas fa-search" title="搜索"></i></a></li><li id="fullscreen_li" class="fullscreen"><a href="javascript:void(0);" class="modal-trigger waves-effect waves-light"><i id="fullscreen" class="fa fa-expand-arrows-alt" title="全屏"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/medias/logo-3.png" class="logo-img circle responsive-img"><div class="logo-name">斯莫笔记</div><div class="logo-desc">Small-Rose,张小菜苔,个人技术笔记,记录学习/开发问题</div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fa-fw fas fa-home"></i> 首页</a></li><li class="m-nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fa-fw fas fa-tags"></i> 标签</a></li><li class="m-nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fa-fw fas fa-bookmark"></i> 分类</a></li><li class="m-nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fa-fw fas fa-archive"></i> 归档</a></li><li class="m-nav-item"><a href="/about" class="waves-effect waves-light"><i class="fa-fw fas fa-user-circle"></i> 关于</a></li><li class="m-nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fa-fw fas fa-comments"></i> 留言簿</a></li><li class="m-nav-item"><a href="/artitalk" class="waves-effect waves-light"><i class="fa-fw fas fa-heartbeat"></i> ArtiTalk</a></li><li class="m-nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fa-fw fas fa-address-book"></i> 友情链接</a></li><li class="m-nav-item"><a href="https://travellings.now.sh/" target="_blank" rel="noopener" class="waves-effect waves-light"><i class="fa-fw fas fa-location-arrow"></i> Travellings</a></li><li class="m-nav-item"><a href="http://chat.zhangxiaocai.cn/" target="_blank" rel="noopener" class="waves-effect waves-light"><i class="fa-fw fas fa fa-comment-alt"></i> Tyloo</a></li><li class="m-nav-item"><a href="javascript:;"><i class="fa-fw fas fa-list"></i> Secret <span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a href="/navigate" style="margin-left:75px"><i class="fa fas fa-location-arrow" style="position:absolute;left:50px"></i> <span>Navigation</span></a></li><li><a href="/box" style="margin-left:75px"><i class="fa fas fa-map-marker" style="position:absolute;left:50px"></i> <span>Siteboxing</span></a></li><li><a href="https://blog.zhangxiaocai.cn" target="_blank" rel="noopener" style="margin-left:75px"><i class="fa fas fa-pen-alt" style="position:absolute;left:50px"></i> <span>Writinging</span></a></li><li><a href="https://hut.zhangxiaocai.cn" target="_blank" rel="noopener" style="margin-left:75px"><i class="fa fas fa-pen-alt" style="position:absolute;left:50px"></i> <span>Memerieding</span></a></li><li><a href="https://yun.zhangxiaocai.cn" target="_blank" rel="noopener" style="margin-left:75px"><i class="fa fas fa-cloud" style="position:absolute;left:50px"></i> <span>SmallCloud</span></a></li><li><a href="/color" style="margin-left:75px"><i class="fa fas fa-asterisk" style="position:absolute;left:50px"></i> <span>ColorWorld</span></a></li><li><a href="https://status.zhangxiaocai.cn/" target="_blank" rel="noopener" style="margin-left:75px"><i class="fa fa fa-yin-yang" style="position:absolute;left:50px"></i> <span>SiteStatus</span></a></li></ul></li></ul></div></div></nav></header><div class="bg-cover pd-header post-cover" style="background-image:url(https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/medias/featureimages/34.jpg)"><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand"><h1 class="description center-align post-title">Memcache 快速上手</h1></div></div></div></div></div><main class="post-container content"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/tocbot/tocbot.css"><style>#articleContent h1::before,#articleContent h2::before,#articleContent h3::before,#articleContent h4::before,#articleContent h5::before,#articleContent h6::before{display:block;content:" ";height:100px;margin-top:-100px;visibility:hidden}#articleContent :focus{outline:0}.toc-fixed{position:fixed;top:64px}.toc-widget{width:345px;padding-left:20px}.toc-widget .toc-title{margin:35px 0 15px 0;padding-left:17px;font-size:1.5rem;font-weight:700;line-height:1.5rem}.toc-widget ol{padding:0;list-style:none}#toc-content{height:calc(100vh - 250px);overflow:auto}#toc-content ol{padding-left:10px}#toc-content ol li{padding-left:10px}#toc-content .toc-link:hover{color:#42b983;font-weight:700;text-decoration:underline}#toc-content .toc-link::before{background-color:transparent;max-height:25px;position:absolute;right:23.5vw;display:block}#toc-content .is-active-link{color:#42b983}#floating-toc-btn{position:fixed;right:32px;bottom:155px;padding-top:15px;margin-bottom:0;z-index:998}#floating-toc-btn .btn-floating{width:48px;height:48px}#floating-toc-btn .btn-floating i{line-height:48px;font-size:1.4rem}</style><div class="row"><div id="main-content" class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="/tags/Memcache/"><span class="chip bg-color">Memcache</span></a></div></div><div class="col s5 right-align"><div class="post-cate"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/Memcache/" class="post-category">Memcache</a></div></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp; 2020-10-24</div><div class="info-break-policy"><i class="fa fa-pencil"></i> 作者: Small-Rose / 张小菜</div><div class="post-date info-break-policy"><i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp; 2020-10-24</div><div class="info-break-policy"><i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp; 3.5k</div><div class="info-break-policy"><i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp; 14 分</div><div id="busuanzi_container_page_pv" class="info-break-policy"><i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp; <span id="busuanzi_value_page_pv"></span></div></div></div><hr class="clearfix"><div class="card-content article-card-content"><div id="articleContent"><h2 id="Memcache-快速入门"><a href="#Memcache-快速入门" class="headerlink" title="Memcache 快速入门"></a>Memcache 快速入门</h2><h2 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h2><h3 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h3><p>Memcache是一个自由和开放源代码、高性能、分配的内存对象缓存系统。用于加速动态web应用程序，减轻数据库负载。也有称呼为旁路式缓存系统。</p><p>与旁路式缓存系统相对的还有一种叫穿透式缓存系统，一般将正向代理或者反向代理成为穿透式缓存系统，因为系统本身就具有获取缓存数据能力，而且不依靠第三方客户端。</p><p>Memcache 也可以理解成是一种特殊的NoSQL 。</p><p>Memcache 可以应对任意多个连接，使用telnet 协议传输作为非阻塞的网络IO。它的工作机制是在内存中开辟一块空间，然后建立一个HashTable，Memcache这个软件项目一般叫Memcache</p><p>Memcache 是一种C/S 架构。</p><h3 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h3><p><strong>优点：</strong></p><p>（1）纯内存存储，速度快。<br>（2）内置分布式算法，开发者不需要自己实现。<br>（3）能把单项数据缓存过期时间设置为30天，可以使单项数据常驻内存中。</p><p><strong>缺点：</strong></p><p>（1）使用telnet 协议传输，没有数据加密功能，安全性很差。<br>（2）最大内的默认存储空间（吞吐量）只有64M，如果64M 的内存爆满，会指定重启。（可以通过参数指定大小，自带内存不够用的处理机制）<br>（3）数据放在内存中，服务器重启数据丢失。（不允许数据一起丢失，和redis缓存集体失效效果相似，造成缓存击穿，可能引发缓存雪崩，可以像redis一样使用集群模式使用）<br>（4）在内存中存储地址非连续，数据零散，无法遍历，管理数据完整性一般。</p><p>Nosql 存储 多以K-V键值对的方式存储。</p><p>hash表存储的好处是将检索遍历的时间复杂度变成O(1)，理论上使用hash保存数据，不会碎数据量的增加查询变慢，响应基本不变。</p><p>hash表存储弊端是数据在内存区域中随机分布。</p><p>hash表存储弊端还会引发 hash碰撞。多个key对应了同一个值的现象，理论上是存在的，但是发生概率低。比如HashMap 存值时，hashcode相等的时候，只能去比较key来存储，然后在相同hashcode的位置改用链表来存储。</p><p>官网：<a href="http://www.memcached.org/about" target="_blank" rel="noopener">http://www.memcached.org/about</a></p><p>github 下载：<a href="https://github.com/memcached/memcached/wiki/ReleaseNotes" target="_blank" rel="noopener">https://github.com/memcached/memcached/wiki/ReleaseNotes</a></p><h2 id="二、安装使用"><a href="#二、安装使用" class="headerlink" title="二、安装使用"></a>二、安装使用</h2><h3 id="windows-版-（开发环境）"><a href="#windows-版-（开发环境）" class="headerlink" title="windows 版 （开发环境）"></a>windows 版 （开发环境）</h3><p>直接下载包即可。</p><p>官网最新版: <a href="https://github.com/memcached/memcached/archive/1.6.7.zip" target="_blank" rel="noopener">memcached 1.6.7.zip</a></p><p>官网最新版: <a href="https://github.com/memcached/memcached/archive/1.6.7.zip" target="_blank" rel="noopener">memcached 1.6.7.zip</a></p><p>windows 版的下载之后直接解压即可使用。</p><p>目录：<code>D:\memcache\memcached-win64-1.4.4-14\memcached</code></p><h4 id="版本注意"><a href="#版本注意" class="headerlink" title="版本注意"></a>版本注意</h4><p>memcached 1.4.5 之前的版本在window上刻有安装成服务。</p><pre class="language-bash"><code class="language-bash">memcached.exe -d <span class="token function">install</span></code></pre><p>务必使用管理员方式启动CMD窗口。</p><p>注册表位置：<code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\memcached</code> 刻有进行手动修改配置项，</p><p>也可以使用命令的方式卸载安装的服务：</p><pre class="language-bash"><code class="language-bash">memcached.exe -d uninstall</code></pre><p>启动或停止服务：</p><pre class="language-bash"><code class="language-bash">memcached.exe -d start

memcached.exe -d stop</code></pre><p>如果不按照服务，那么使用时不能关闭cmd窗口，一次性安装，关闭窗口就会停止。</p><p>memcached 1.4.5 及之后的版本不能作为服务运行，可以任务计划中来开启一个普通的进程，在 window 启动时设置 memcached自动执行。</p><p>需要使用管理员身份执行以下命令将 memcached 添加来任务计划表中：</p><pre class="language-bash"><code class="language-bash">schtasks /create /sc onstart /tn memcached /tr <span class="token string">"'c:\memcached\memcached.exe' -m 100"</span></code></pre><p>删除任务计划</p><pre class="language-bash"><code class="language-bash">schtasks /delete /tn memcached</code></pre><h4 id="常用管理命令"><a href="#常用管理命令" class="headerlink" title="常用管理命令"></a>常用管理命令</h4><p>进入memcache目录：</p><pre class="language-bash"><code class="language-bash"><span class="token function">cd</span> D:\memcache\memcached-win64-1.4.4-14\memcached</code></pre><p>帮助命令查看这种参数：</p><pre class="language-bash"><code class="language-bash">D:\memcache\memcached-win64-1.4.4-14\memcached<span class="token operator">></span> memcached.exe -h 
memcached 1.4.4-14-g9c660c0
-p <span class="token operator">&lt;</span>num<span class="token operator">></span>      TCP port number to listen on <span class="token punctuation">(</span>default: 11211<span class="token punctuation">)</span>
-U <span class="token operator">&lt;</span>num<span class="token operator">></span>      UDP port number to listen on <span class="token punctuation">(</span>default: 11211, 0 is off<span class="token punctuation">)</span>
-s <span class="token operator">&lt;</span>file<span class="token operator">></span>     UNIX socket path to listen on <span class="token punctuation">(</span>disables network support<span class="token punctuation">)</span>
-a <span class="token operator">&lt;</span>mask<span class="token operator">></span>     access mask <span class="token keyword">for</span> UNIX socket, <span class="token keyword">in</span> octal <span class="token punctuation">(</span>default: 0700<span class="token punctuation">)</span>
-l <span class="token operator">&lt;</span>ip_addr<span class="token operator">></span>  interface to listen on <span class="token punctuation">(</span>default: INADDR_ANY, all addresses<span class="token punctuation">)</span>
-s <span class="token operator">&lt;</span>file<span class="token operator">></span>     unix socket path to listen on <span class="token punctuation">(</span>disables network support<span class="token punctuation">)</span>
-a <span class="token operator">&lt;</span>mask<span class="token operator">></span>     access mask <span class="token keyword">for</span> unix socket, <span class="token keyword">in</span> octal <span class="token punctuation">(</span>default 0700<span class="token punctuation">)</span>
-l <span class="token operator">&lt;</span>ip_addr<span class="token operator">></span>  interface to listen on, default is INADDR_ANY
-d start          tell memcached to start
-d restart        tell running memcached to <span class="token keyword">do</span> a graceful restart
-d stop<span class="token operator">|</span><span class="token function">shutdown</span>  tell running memcached to <span class="token function">shutdown</span>
-d <span class="token function">install</span>        <span class="token function">install</span> memcached <span class="token function">service</span>
-d uninstall      uninstall memcached <span class="token function">service</span>
-r            maximize core <span class="token function">file</span> limit
-u <span class="token operator">&lt;</span>username<span class="token operator">></span> assume identity of <span class="token operator">&lt;</span>username<span class="token operator">></span> <span class="token punctuation">(</span>only when run as root<span class="token punctuation">)</span>
-m <span class="token operator">&lt;</span>num<span class="token operator">></span>      max memory to use <span class="token keyword">for</span> items <span class="token keyword">in</span> megabytes <span class="token punctuation">(</span>default: 64 MB<span class="token punctuation">)</span>
-M            <span class="token keyword">return</span> error on memory exhausted <span class="token punctuation">(</span>rather than removing items<span class="token punctuation">)</span>
-c <span class="token operator">&lt;</span>num<span class="token operator">></span>      max simultaneous connections <span class="token punctuation">(</span>default: 1024<span class="token punctuation">)</span>
-k            lock down all paged memory.  Note that there is a
              limit on how much memory you may lock.  Trying to
              allocate <span class="token function">more</span> than that would fail, so be sure you
              <span class="token keyword">set</span> the limit correctly <span class="token keyword">for</span> the user you started
              the daemon with <span class="token punctuation">(</span>not <span class="token keyword">for</span> -u <span class="token operator">&lt;</span>username<span class="token operator">></span> user<span class="token punctuation">;</span>
              under sh this is <span class="token keyword">done</span> with <span class="token string">'ulimit -S -l NUM_KB'</span><span class="token punctuation">)</span>.
-v            verbose <span class="token punctuation">(</span>print errors/warnings <span class="token keyword">while</span> <span class="token keyword">in</span> event loop<span class="token punctuation">)</span>
-vv           very verbose <span class="token punctuation">(</span>also print client commands/reponses<span class="token punctuation">)</span>
-vvv          extremely verbose <span class="token punctuation">(</span>also print internal state transitions<span class="token punctuation">)</span>
-h            print this <span class="token function">help</span> and <span class="token keyword">exit</span>
-i            print memcached and libevent license
-P <span class="token operator">&lt;</span>file<span class="token operator">></span>     save PID <span class="token keyword">in</span> <span class="token operator">&lt;</span>file<span class="token operator">></span>, only used with -d option
-f <span class="token operator">&lt;</span>factor<span class="token operator">></span>   chunk size growth factor <span class="token punctuation">(</span>default: 1.25<span class="token punctuation">)</span>
-n <span class="token operator">&lt;</span>bytes<span class="token operator">></span>    minimum space allocated <span class="token keyword">for</span> key+value+flags <span class="token punctuation">(</span>default: 48<span class="token punctuation">)</span>
-L            Try to use large memory pages <span class="token punctuation">(</span>if available<span class="token punctuation">)</span>. Increasing
              the memory page size could reduce the number of TLB misses
              and improve the performance. In order to get large pages
              from the OS, memcached will allocate the total item-cache
              <span class="token keyword">in</span> one large chunk.
-D <span class="token operator">&lt;</span>char<span class="token operator">></span>     Use <span class="token operator">&lt;</span>char<span class="token operator">></span> as the delimiter between key prefixes and IDs.
              This is used <span class="token keyword">for</span> per-prefix stats reporting. The default is
              <span class="token string">":"</span> <span class="token punctuation">(</span>colon<span class="token punctuation">)</span>. If this option is specified, stats collection
              is turned on automatically<span class="token punctuation">;</span> <span class="token keyword">if</span> not, <span class="token keyword">then</span> it may be turned on
              by sending the <span class="token string">"stats detail on"</span> <span class="token function">command</span> to the server.
-t <span class="token operator">&lt;</span>num<span class="token operator">></span>      number of threads to use <span class="token punctuation">(</span>default: 4<span class="token punctuation">)</span>
-R            Maximum number of requests per event, limits the number of
              requests process <span class="token keyword">for</span> a given connection to prevent
              starvation <span class="token punctuation">(</span>default: 20<span class="token punctuation">)</span>
-C            Disable use of CAS
-b            Set the backlog queue limit <span class="token punctuation">(</span>default: 1024<span class="token punctuation">)</span>
-B            Binding protocol - one of ascii, binary, or auto <span class="token punctuation">(</span>default<span class="token punctuation">)</span>
-I            Override the size of each slab page. Adjusts max item size
              <span class="token punctuation">(</span>default: 1mb, min: 1k, max: 128m<span class="token punctuation">)</span></code></pre><p>修改默认端口 11211：</p><pre class="language-bash"><code class="language-bash">memcached.exe -p 112222</code></pre><p>修改默认内存大小：</p><pre class="language-bash"><code class="language-bash">memcached.exe -m 1024</code></pre><p>后台运行,需要linux 环境生效：</p><pre class="language-bash"><code class="language-bash">memcached.exe -d </code></pre><p>启用交互模式，打印日志信息：</p><pre class="language-bash"><code class="language-bash">memcached.exe -VVV</code></pre><h4 id="Telnet-常用命令"><a href="#Telnet-常用命令" class="headerlink" title="Telnet 常用命令"></a>Telnet 常用命令</h4><p>服务安装、启动之后可以使用客户端管理操作。</p><p>可以使用 Telnet 作为客户端进行操作。如果不能使用请打开启用 window 的 Telnet 服务模块。</p><pre class="language-bash"><code class="language-bash">telnet localhost 11211</code></pre><p>本机登录可省。</p><p>回车之后使用 <code>ctrl+]</code> 进入Telnet 命令模式。</p><p>注意 Telnet命令敲错了直接回车即可，Telnet 不支持回退，重写命令即可。</p><p>退出Telnet 命令模式 使<code>quit</code>命令即可。</p><p>登录memcache之后常用命令：</p><p>展示服务器信息。</p><pre class="language-bash"><code class="language-bash">stats </code></pre><p>get_hits / cmd_get 即命中数量 / 总的获取次数 可以计算出缓存命中率。实际命中率参考标准最少要有90%。</p><p>memadmin 图形界面可以查看。</p><p><strong>add 命令</strong></p><p>命令格式：</p><pre class="language-bash"><code class="language-bash">add key  flag  expires bytes
value</code></pre><ul><li>key ：代表需要存储的key</li><li>flag ： 代表是否对存储的数据进行压缩，0-代表不压缩；1-代表压缩；一般不压缩，节省系统资源消耗。</li><li>expires ： 代表 value 值的失效时间，单位是秒（s）。如果设置为0，代表不过期，但是mamcache 里面存着一个最大的保留时间为 30 天。当memcache 的存储不够用的时候，会优先剔除这些长期有效的数据，以释放空间供其他数据缓存使用。使用的最近最少使用算法（LRU）进行缓存剔除。</li><li>bytes： 代表存储value 值的字节数。</li><li>value：存储的值（始终位于第二行）（可直接理解为key-value结构中的value）</li></ul><p>命令回车之后设value值即可。</p><p>示例：</p><pre class="language-bash"><code class="language-bash">add name 0 60 2</code></pre><p><strong>get命令</strong></p><pre class="language-bash"><code class="language-bash">get name</code></pre><p><strong>set命令</strong><br>这个命令类似hashMap的add方法，如果key存在就直接替换value，如果没有key就创建key设置缓存。</p><pre class="language-bash"><code class="language-bash"><span class="token keyword">set</span> name 0 60 4
<span class="token function">test</span>
<span class="token keyword">set</span> name  xiaocai</code></pre><p><strong>delete命令- 删除key</strong></p><pre class="language-bash"><code class="language-bash">delete name</code></pre><p><strong>delete命令</strong><br>删除某个缓存，如果key存在则删除，如果key不存在提示NOT_FOUND。</p><pre class="language-bash"><code class="language-bash">delete name</code></pre><p><strong>flush_all命令</strong><br>清空memcache里的所有数据，生产环境慎用。</p><pre class="language-bash"><code class="language-bash">flush_all</code></pre><p>危险级别较高，一般只在测试环境使用。</p><p><strong>incr 自增命令</strong><br>和redis 的 incr基本一样。</p><pre class="language-bash"><code class="language-bash">incr key increment_value</code></pre><p>increment_value : 步长值，步进值</p><p>示例：</p><pre class="language-bash"><code class="language-bash"><span class="token keyword">set</span> viewers 0 1000 2
10
STORED
incr viewers 2
12
END</code></pre><p><strong>decr 自减命令</strong></p><pre class="language-bash"><code class="language-bash">decr key decrement_value</code></pre><p>和 incr 类似。</p><p>使用场景：经常变换的数据可以放缓存里，再配合定时任务更新到数据库进行持久化，减少数据库的频繁更新。</p><h3 id="Linux-版（部署环境）"><a href="#Linux-版（部署环境）" class="headerlink" title="Linux 版（部署环境）"></a>Linux 版（部署环境）</h3><p>gitHub下载地址：<a href="https://github.com/memcached/memcached/archive/1.5.20.tar.gz" target="_blank" rel="noopener">memcached 1.5.20.tar.gz</a></p><p>官网下载：<a href="http://www.memcached.org/files/memcached-1.6.7.tar.gz" target="_blank" rel="noopener">memcached-1.6.7.tar.gz</a></p><p>下自tar 包 <code>memcached-1.6.7.tar.gz</code> ，下载优先选择稳定版。如果没有你喜欢的版本，可以到gitHub 找历史版本。</p><p>memcache 的底层依赖一个 libevent 库，需要先安装这个依赖库，官网地址是：<a href="http://libevent.org" target="_blank" rel="noopener">http://libevent.org</a></p><p>gitHub下载地址：<a href="https://github.com/libevent/libevent/releases/download/release-2.1.12-stable/libevent-2.1.12-stable.tar.gz" target="_blank" rel="noopener">libevent-2.1.12-stable.tar.gz</a></p><p>上传两个tar包到 <code>/usr/local/src</code> 或者 <code>/opt</code> 目录皆可，也可以找个你喜欢的目录，没有你喜欢的目录也可以不上传。</p><p>当然如果环境可以联网也可以使用 yum 安装 或者 wget 下载。</p><p>在线安装：</p><pre class="language-bash"><code class="language-bash">yum <span class="token function">install</span> memcached</code></pre><p>下载：</p><pre class="language-bash"><code class="language-bash"><span class="token function">wget</span> http://memcached.org/latest</code></pre><p><strong>开始安装：</strong></p><p>（1）安装 libevent 依赖库</p><pre class="language-bash"><code class="language-bash"><span class="token function">tar</span> -zxvf libevent-2.1.12-stable.tar.gz

<span class="token function">cd</span>  libevent-2.1.12-stable

./configure --prefix<span class="token operator">=</span>/usr/local/libevent  <span class="token operator">&amp;&amp;</span> <span class="token function">make</span>  <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span></code></pre><p><code>--prefix=/usr/local/libevent</code> 指定安装目录。</p><p>等待安装成功，不报error即可。</p><p>（2）安装 memcache</p><pre class="language-bash"><code class="language-bash"><span class="token function">tar</span> -zxvf memcached-1.6.7.tar.gz

<span class="token function">cd</span>  memcached-1.6.7

./configure --prefix<span class="token operator">=</span>/usr/local/memcache --with-libevent<span class="token operator">=</span>/usr/local/libevent <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span></code></pre><p>等待安装成功即可。</p><p>（3）验证与使用</p><p>进入安装目录查看是否有安装的文件，测试memcache 命令。</p><p>检查文件，正常安装了应该不会有问题。</p><pre class="language-bash"><code class="language-bash"><span class="token function">cd</span> /usr/local/memcache/bin
<span class="token function">ls</span></code></pre><p>测试命令</p><pre class="language-bash"><code class="language-bash">./memcached -h</code></pre><p>其他命令：</p><pre class="language-bash"><code class="language-bash">./memcached -h 32 -p 11211 -u nobody - d</code></pre><p><code>-u</code> : 以说明身份启动<br><code>-d</code> : 以守护进程启动。</p><p>检查进程：</p><pre class="language-bash"><code class="language-bash"><span class="token function">ps</span> aux <span class="token operator">|</span> <span class="token function">grep</span> memcached</code></pre><p>然后使用Telnet 命令测试连接，执行查看状态的命令：<code>stats</code>:</p><pre class="language-bash"><code class="language-bash">telnet <span class="token punctuation">[</span>你的memcache主机IP<span class="token punctuation">]</span>  11211
stats</code></pre><h3 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h3><h4 id="内存预先分配机制"><a href="#内存预先分配机制" class="headerlink" title="内存预先分配机制"></a>内存预先分配机制</h4><p>内存或磁盘管理存在内存碎片化。内存条线性寻址时，存在无法被使用的内存单元。</p><p>memcache 内部使用了内存预先分配机制。</p><p>使用之后可以使用 <code>-VVV</code> 查看。</p><p><strong>内存预先分配机制</strong></p><p>memcache 接收到 <code>-m 32</code> 的参数之后，将内存分成32个slab class，每个1M大小的<code>slab class</code>里面有多个chunk，每个chunk（最小chunk为96个字节）比前一个大一点点（默认是1.25倍），相邻的chunk直接比值固定，被称为增长因子，增长因子可以根据实际的业务数据大小做调整，最大不会超过1个slab class（即1M），所以，memcache 里最大的value是1M。</p><p>如果想修改最小的chunk是需要源码编译才可以修改。</p><p>增长因子修改：</p><pre class="language-bash"><code class="language-bash">memcached.exe -p 11211 -m 32 -f 3 -VVV</code></pre><p>调整之后slab class 会减少，chunk 的空间会变大。</p><p>memcache的内存预先分配机制，有效优化了内存碎片化和内存管理。</p><h4 id="LRU-算法"><a href="#LRU-算法" class="headerlink" title="LRU 算法"></a>LRU 算法</h4><p>LRU算法，称为最近最少使用原则的算法，当memcache的一个slab 里面的chunk不够使用的情况下（存储满了，数据在有效期），当有新的满足chunk的数据过来的时候，memcache会优先吧slab里面最近一段时间内、最不活跃的数据优先剔除掉，腾出空间给新的数据使用。</p><h4 id="惰性删除机制"><a href="#惰性删除机制" class="headerlink" title="惰性删除机制"></a>惰性删除机制</h4><p>memcache本身不监控数据是否过期，即使某个key过期了，memcache也不会立刻直接清除，直到下一次进行获取数据的时候，才会去判断数据是否失效，如果失效也不会清除动作，只是进行过期标记，下次存储数据的时候直接在该过期数据位置存在新数据。</p><h2 id="三、MemAdmin"><a href="#三、MemAdmin" class="headerlink" title="三、MemAdmin"></a>三、MemAdmin</h2><p>MemAdmin 是一款可视化 memcache 管理与监控工具。基于 PHP5 &amp; JQuery 开发的，体积小，操作简单。</p><p>官网：<a href="http://www.junopen.com/memadmin" target="_blank" rel="noopener">http://www.junopen.com/memadmin</a></p><p>需要配合php运行环境。</p><p>解压之后复制到php站点部署目录，如phpstudy。</p><h2 id="四、集群。"><a href="#四、集群。" class="headerlink" title="四、集群。"></a>四、集群。</h2><p>memcache集群也可以称为memcache分布式缓存系统。</p><p>多台memcache组成的架构服务。</p><p>memcache 内部使用的内置的取模算法。</p><p>后续实操之后再补充。</p><h2 id="五、面试题"><a href="#五、面试题" class="headerlink" title="五、面试题"></a>五、面试题</h2><h3 id="1、问题1"><a href="#1、问题1" class="headerlink" title="1、问题1"></a>1、问题1</h3><p><strong>问题： memcache 最大缓存时间30天，如果要设置31天怎么办？</strong></p><p><strong>缓存有效期</strong></p><p>缓存时间设置方式：</p><ul><li>使用s秒数，但是不能超过<code>86400*30s</code>，即不能超过30天。</li><li>设置时间戳，该方式只在linux下可以使用，Windows下不能生效。</li></ul><p>所以设置超过30天的缓存实际的数据需要使用时间戳，<code>time() + 86400 * 31</code>。<br>不设置有效期是默认30天有效期，手工设置有效期超过30天只能使用时间戳的方式设置，并且只能在linux环境下使用才生效。</p><h3 id="2、问题2"><a href="#2、问题2" class="headerlink" title="2、问题2"></a>2、问题2</h3><p><strong>问题： memcache 是否支持高可用？</strong></p><p>如果要进行持久化可以配和 memcacheDb</p><h3 id="3、问题3"><a href="#3、问题3" class="headerlink" title="3、问题3"></a>3、问题3</h3><p><strong>问题： 谈谈 memcache 和 memcached 之间的区别</strong></p><p>memcache 和 memcached 都是可以作为php扩展出现。memcache在windows下使用，memcached在linux下使用。</p><p>memcache 指的是 memcache 软件或项目名称。<br>memcached 值项目在linux服务下一个守护进程。memcached = memcache + daemon（守护进程）</p><h3 id="4、问题4"><a href="#4、问题4" class="headerlink" title="4、问题4"></a>4、问题4</h3><p><strong>问题： memcache 可以用在哪些使用场景？</strong></p><p>（1）统计在线人数<br>（2）缓存网站的常用数据<br>（3）访问频率限制功能（发现验证码次数、银行相关密码错误限制登录）<br>（4）浏览量数据统计<br>（5）实时排行榜<br>（6）可以做session 共享</p><p>redis 同理可以做这些事。</p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css"></div><br><hr><div class="reprint" id="reprint-statement"><div class="reprint__author"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-user">文章作者: </i></span><span class="reprint-info"><a href="/about" rel="external nofollow noreferrer">Small-Rose / 张小菜</a></span></div><div class="reprint__type"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-link">文章链接: </i></span><span class="reprint-info"><a href="https://www.zhangxiaocai.cn/posts/193c9d75.html">https://www.zhangxiaocai.cn/posts/193c9d75.html</a></span></div><div class="reprint__notice"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-copyright">版权声明: </i></span><span class="reprint-info">本博客所有文章除特別声明外，均采用 <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a> 许可协议。转载请注明来源 <a href="/about" target="_blank">Small-Rose / 张小菜</a> !</span></div></div><script async defer>document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }</script><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><a href="/tags/Memcache/"><span class="chip bg-color">Memcache</span></a></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div><script src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/share/js/social-share.min.js"></script></div></div></div><style>#reward{margin:40px 0;text-align:center}#reward .reward-link{font-size:1.4rem;line-height:38px}#reward .btn-floating:hover{box-shadow:0 6px 12px rgba(0,0,0,.2),0 5px 15px rgba(0,0,0,.2)}#rewardModal{width:320px;height:350px}#rewardModal .reward-title{margin:15px auto;padding-bottom:5px}#rewardModal .modal-content{padding:10px}#rewardModal .close{position:absolute;right:15px;top:15px;color:rgba(0,0,0,.5);font-size:1.3rem;line-height:20px;cursor:pointer}#rewardModal .close:hover{color:#ef5350;transform:scale(1.3);-moz-transform:scale(1.3);-webkit-transform:scale(1.3);-o-transform:scale(1.3)}#rewardModal .reward-tabs{margin:0 auto;width:210px}.reward-tabs .tabs{height:38px;margin:10px auto;padding-left:0}.reward-content ul{padding-left:0!important}.reward-tabs .tabs .tab{height:38px;line-height:38px}.reward-tabs .tab a{color:#fff;background-color:#ccc}.reward-tabs .tab a:hover{background-color:#ccc;color:#fff}.reward-tabs .wechat-tab .active{color:#fff!important;background-color:#22AB38!important}.reward-tabs .alipay-tab .active{color:#fff!important;background-color:#019FE8!important}.reward-tabs .reward-img{width:210px;height:210px}</style><div id="reward"><a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close modal-close"><i class="fas fa-times"></i></a><h4 class="reward-title">你的赏识是我前进的动力</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs row"><li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li><li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li></ul><div id="alipay"><img src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码"></div><div id="wechat"><img src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/medias/reward/wechat.jpg" class="reward-img" alt="微信打赏二维码"></div></div></div></div></div></div><script>$(function(){$(".tabs").tabs()})</script></div></div><style>.valine-card{margin:1.5rem auto}.valine-card .card-content{padding:20px 20px 5px 20px}#vcomments textarea{box-sizing:border-box;background:url(/medias/202007bg.webp) 100% 100% no-repeat}#vcomments p{margin:2px 2px 10px;font-size:1.05rem;line-height:1.78rem}#vcomments blockquote p{text-indent:.2rem}#vcomments a{padding:0 2px;color:#4cbf30;font-weight:500;text-decoration:none}#vcomments img{max-width:100%;height:auto;cursor:pointer}#vcomments ol li{list-style-type:decimal}#vcomments ol,ul{display:block;padding-left:2em;word-spacing:.05rem}#vcomments ul li,ol li{display:list-item;line-height:1.8rem;font-size:1rem}#vcomments ul li{list-style-type:disc}#vcomments ul ul li{list-style-type:circle}#vcomments table,td,th{padding:12px 13px;border:1px solid #dfe2e5}#vcomments table,td,th{border:0}table tr:nth-child(2n),thead{background-color:#fafafa}#vcomments table th{background-color:#f2f2f2;min-width:80px}#vcomments table td{min-width:80px}#vcomments h1{font-size:1.85rem;font-weight:700;line-height:2.2rem}#vcomments h2{font-size:1.65rem;font-weight:700;line-height:1.9rem}#vcomments h3{font-size:1.45rem;font-weight:700;line-height:1.7rem}#vcomments h4{font-size:1.25rem;font-weight:700;line-height:1.5rem}#vcomments h5{font-size:1.1rem;font-weight:700;line-height:1.4rem}#vcomments h6{font-size:1rem;line-height:1.3rem}#vcomments p{font-size:1rem;line-height:1.5rem}#vcomments hr{margin:12px 0;border:0;border-top:1px solid #ccc}#vcomments blockquote{margin:15px 0;border-left:5px solid #42b983;padding:1rem .8rem .3rem .8rem;color:#666;background-color:rgba(66,185,131,.1)}#vcomments pre{font-family:monospace,monospace;padding:1.2em;margin:.5em 0;background:#272822;overflow:auto;border-radius:.3em;tab-size:4}#vcomments code{font-family:monospace,monospace;padding:1px 3px;font-size:.92rem;color:#e96900;background-color:#f8f8f8;border-radius:2px}#vcomments pre code{font-family:monospace,monospace;padding:0;color:#e8eaf6;background-color:#272822}#vcomments pre[class*=language-]{padding:1.2em;margin:.5em 0}#vcomments code[class*=language-],pre[class*=language-]{color:#e8eaf6}#vcomments [type=checkbox]:not(:checked),[type=checkbox]:checked{position:inherit;margin-left:-1.3rem;margin-right:.4rem;margin-top:-1px;vertical-align:middle;left:unset;visibility:visible}#vcomments b,strong{font-weight:700}#vcomments dfn{font-style:italic}#vcomments small{font-size:85%}#vcomments cite{font-style:normal}#vcomments mark{background-color:#fcf8e3;padding:.2em}#vcomments table,td,th{padding:12px 13px;border:1px solid #dfe2e5}table tr:nth-child(2n),thead{background-color:#fafafa}#vcomments table th{background-color:#f2f2f2;min-width:80px}#vcomments table td{min-width:80px}#vcomments [type=checkbox]:not(:checked),[type=checkbox]:checked{position:inherit;margin-left:-1.3rem;margin-right:.4rem;margin-top:-1px;vertical-align:middle;left:unset;visibility:visible}#vcomments .vbtn{background-color:#0bb7fbd6;color:#fff}.v[data-class="v"] .vwrap .vheader .vinput{width:32%;border-bottom:1px dashed #dedede}.v[data-class=v] .vwrap .vemojis i{font-style:normal;padding-top:7px;width:36px;cursor:pointer;text-align:center;display:inline-block;vertical-align:middle;padding-right:3px;padding-left:3px}</style><div class="card valine-card" data-aos="fade-up"><div class="comment_headling" style="font-size:20px;font-weight:700;position:relative;padding-left:20px;top:15px;padding-bottom:5px"><i class="fas fa-comments fa-fw" aria-hidden="true"></i> <span>评论</span></div><div id="vcomments" class="card-content" style="display:grid"></div></div><script src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/valine/av-min.js"></script><script src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/valine/Valine.min.js"></script><script>let metaPlaceholder = {"nick":"昵称/QQ号(必填)","mail":"邮箱(必填)","link":"网址(https://)"}

    new Valine({
        el: '#vcomments',
        mode: 'xCss',
        appId: 'iTxfqh5e9IaRfiiVOTbIWoKa-9Nh9j0Va',
        appKey: 'C5s5xGFErD1Et90bvbPvNDsB',
        notify: 'true' === 'true',
        verify: 'true' === 'true',
        visitor: 'true' === 'true',
        avatar: 'monsterid',
        pageSize: '10',
        lang: 'zh-CN',
        placeholder: 'ヾﾉ≧∀≦)o来啊，快活啊！什么？想走？打劫！赶紧提交出你的评论，全部要写好~ ',
        meta: ["nick", "mail", "link"],
        recordIP: 'true' === 'true',
        enableQQ: 'monsterid',
        requiredFields: ["68c4c9e1b9a3d34317dc6faefe2ea00e"],
        master: ["68c4c9e1b9a3d34317dc6faefe2ea00e"],
        friends: ["7a455d704b60807098d18cc8c2470da2", "8acd51671b7e0e1dc68cc76d4d987813", "c08508165c8eba9a77f87285c046d09e", "901345d4c91ddfd8db0f975bbceaf0c8", "1512958e18378c98b498d5ef8e3e763f", "db6069f3bda06d2a9157c4a622ce4648", "fc2c9b067f65c9e2d7057ba797f7cfca", "256a83cdeb9a494df572ef260e98c9bf", "9f38a40d977e6e8a6a555fef3849f23a", "95dbe659464f10506676f48b11962ef7", "93c72e67b6b84508525f5566b865db2d"],
        tagMeta: ["博主", "小伙伴", "访客"],
        metaPlaceholder: metaPlaceholder,

    });

    document.body.addEventListener('click', function(e) {
    if (e.target.classList.contains('vsubmit')) {
        const email = document.querySelector('input[type=email]');
        const nick = document.querySelector('input[name=nick]');
        const reg = /^[A-Za-z0-9_-\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;
        if (!email.value || !nick.value || !reg.test(email.value)) {
            const str = `<div class="valert txt-center"><div class="vtext">请填写正确的昵称和邮箱！</div></div>`;
            const vmark = document.querySelector('.vmark');
            vmark.innerHTML = str;
            vmark.style.display = 'block';

            e.stopPropagation();

            setTimeout(function() {
                vmark.style.display = 'none';
                vmark.innerHTML = '';
            }, 2500);
        }
    }
    }, true);</script><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fas fa-chevron-left"></i>&nbsp;上一篇</div><div class="card"><a href="/posts/78ec1f93.html"><div class="card-image"><img src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/medias/featureimages/0.jpg" class="responsive-img" alt="SpringBoot Cache"> <span class="card-title">SpringBoot Cache</span></div></a><div class="card-content article-content"><div class="summary block-with-text">本文整理SpringBoot Cache学习。</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2020-10-25 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/SpringBoot/" class="post-category">SpringBoot</a></span></div></div><div class="card-action article-tags"><a href="/tags/Cache/"><span class="chip bg-color">Cache</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fas fa-chevron-right"></i></div><div class="card"><a href="/posts/40a54347.html"><div class="card-image"><img src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/medias/featureimages/1.jpg" class="responsive-img" alt="保护色-豆沙绿"> <span class="card-title">保护色-豆沙绿</span></div></a><div class="card-content article-content"><div class="summary block-with-text">文记录关于各类软件保护色设置。</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2020-10-23 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/Tools/" class="post-category">Tools</a></span></div></div><div class="card-action article-tags"><a href="/tags/%E4%BF%9D%E6%8A%A4%E8%89%B2/"><span class="chip bg-color">保护色</span></a></div></div></div></div></article></div><script>$("#articleContent").on("copy",function(e){if("undefined"!=typeof window.getSelection){var n=window.getSelection();if(!((""+n).length<Number.parseInt("120"))){var t=document.getElementsByTagName("body")[0],o=document.createElement("div");o.style.position="absolute",o.style.left="-99999px",t.appendChild(o),o.appendChild(n.getRangeAt(0).cloneContents()),"PRE"===n.getRangeAt(0).commonAncestorContainer.nodeName?o.innerHTML="<pre>"+o.innerHTML+"</pre>":o.innerHTML="<pre>"+o.innerHTML+"</pre>";var i=document.location.href;o.innerHTML+='<br />来源: 斯莫笔记<br />文章作者: Small Rose / 张小菜苔<br />文章链接: <a href="'+i+'">'+i+"</a><br />本文章著作权归作者所有，任何形式的转载都请注明出处。",n.selectAllChildren(o),window.setTimeout(function(){t.removeChild(o)},200)}}})</script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/codeBlock/codeBlockFuction.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/codeBlock/codeLang.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/codeBlock/codeCopy.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/codeBlock/codeShrink.js"></script></div><div id="toc-aside" class="expanded col l3 hide-on-med-and-down"><div class="toc-widget"><div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div><div id="toc-content"></div></div></div></div><div id="floating-toc-btn" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color"><i class="fas fa-list-ul"></i></a></div><script src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/tocbot/tocbot.min.js"></script><script>$(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });</script></main><footer class="page-footer bg-color"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/aplayer/APlayer.min.css"><style>.aplayer .aplayer-lrc p{display:none;font-size:12px;font-weight:700;line-height:16px!important}.aplayer .aplayer-lrc p.aplayer-lrc-current{display:none;font-size:15px;color:#42b983}.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body{left:-66px!important}.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover{left:0!important}</style><div><div class="row"><meting-js class="col l8 offset-l2 m10 offset-m1 s12" server="netease" type="playlist" id="2056253259" fixed="true" autoplay theme="#42b983" loop order="random" preload="auto" volume="0.7" list-folded="true"></meting-js></div></div><script src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/aplayer/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><div class="container row center-align" style="margin-bottom:15px!important"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">2020</span> <a href="/about" target="_blank">Small Rose / 张小菜苔</a> |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a> |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a><br>&nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span class="white-color">398.7k</span>&nbsp;字 <span id="busuanzi_container_site_pv">|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv" class="white-color"></span>&nbsp;次 </span><span id="busuanzi_container_site_uv">|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv" class="white-color"></span>&nbsp;人</span><br><span id="sitetime">载入运行时间...</span><script>function siteTime(){var e=1e3,t=60*e,n=60*t,o=24*n,l=365*o,r=new Date,a="2020",i="5",d="1",m="0",M="0",g="0",s=r.getFullYear(),u=r.getMonth()+1,T=r.getDate(),c=r.getHours(),f=r.getMinutes(),h=r.getSeconds(),y=Date.UTC(a,i,d,m,M,g),H=Date.UTC(s,u,T,c,f,h),I=H-y,B=Math.floor(I/l),D=Math.floor(I/o-365*B),E=Math.floor((I-(365*B+D)*o)/n),L=Math.floor((I-(365*B+D)*o-E*n)/t),v=Math.floor((I-(365*B+D)*o-E*n-L*t)/e);a==s?(document.getElementById("year").innerHTML=s,document.getElementById("sitetime").innerHTML="本站已 <del>安全</del> 苟全运行 "+D+" 天 "+E+" 小时 "+L+" 分钟 "+v+" 秒"):(document.getElementById("year").innerHTML=a+" - "+s,document.getElementById("sitetime").innerHTML="本站已 <del>安全</del> 苟全运行 "+B+" 年 "+D+" 天 "+E+" 小时 "+L+" 分钟 "+v+" 秒")}setInterval(siteTime,1e3)</script><br><span id="icp"><img src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/medias/icp.png" style="vertical-align:text-bottom"> <a href="http://beian.miit.gov.cn/" target="_blank">鄂ICP备19015637号-1</a></span><br></div><div class="col s12 m4 l4 social-link social-statis"><a href="https://github.com/small-rose" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fab fa-github"></i> </a><a href="mailto:small-rose@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fas fa-envelope-open"></i> </a><a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=970175021" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 970175021" data-position="top" data-delay="50"><i class="fab fa-qq"></i> </a><a href="https://stackoverflow.com/users/5063539/small-rose" class="tooltipped" target="_blank" data-tooltip="关注我的知乎: https://stackoverflow.com/users/5063539/small-rose" data-position="top" data-delay="50"><i class="fab fa-zhihu1">知</i> </a><a href="https://yun.zhangxiaocia.cn" class="tooltipped" target="_blank" data-tooltip="个人云盘" data-position="top" data-delay="50"><i class="fas fa-cloud"></i></a></div><br><br><center><a href="https://travellings.now.sh/" target="blank" title="开往-友链接力"><img src="https://travellings.netlify.app/assets/logo.gif" alt="开往下一站" width="120"></a></center></div></footer><div class="progress-bar"></div><script type="text/javascript">window.$crisp=[],window.CRISP_WEBSITE_ID="bf3c468c-2fd7-4dcc-866d-3b008127fff0",function(){d=document,s=d.createElement("script"),s.src="https://client.crisp.chat/l.js",s.async=1,d.getElementsByTagName("head")[0].appendChild(s)}()</script><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input"></div><div id="searchResult"></div></div></div><script src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/js/search.js"></script><script type="text/javascript">$(function(){searchFunc("https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/search.xml","searchInput","searchResult")})</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-arrow-up"></i></a></div><script src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/materialize/materialize.min.js"></script><script src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/masonry/masonry.pkgd.min.js"></script><script src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/aos/aos.js"></script><script src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/scrollprogress/scrollProgress.min.js"></script><script src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/js/matery.js"></script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?90b288cd6d944c8f4f8f0258e60bf981";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><script src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/others/clicklove.js" async></script><script async src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/others/busuanzi.pure.mini.js"></script><script type="text/javascript" size="150" alpha="0.6" zindex="-1" src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/background/ribbon.min.js" async></script><script src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/libs/instantpage/instantpage.js" type="module"></script><script src="/js/sakura.js" type="module"></script><script src="https://cdn.jsdelivr.net/gh/small-rose/small-rose.github.io/js/fullscreen.js" type="module"></script><script>window.imageLazyLoadSetting={isSPA:!1,processImages:null}</script><script>window.addEventListener("load",function(){var a=/\.(gif|jpg|jpeg|tiff|png)$/i,e=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(t){var r=t.parentNode;"A"===r.tagName&&(r.href.match(a)||r.href.match(e))&&(r.href=t.dataset.original)})})</script><script>!function(t){function e(){n&&(i=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var e,o,a=0;a<i.length;a++)e=i[a],0<=(o=e.getBoundingClientRect()).bottom&&0<=o.left&&o.top<=(t.innerHeight+240||document.documentElement.clientHeight+240)&&function(){var t,e,n,o,r=i[a];t=r,e=function(){i=i.filter(function(t){return r!==t})},n=new Image,o=t.getAttribute("data-original"),n.onload=function(){t.src=o,e&&e()},n.src=o}()}t.imageLazyLoadSetting.processImages=e;var n=t.imageLazyLoadSetting.isSPA,i=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));e(),t.addEventListener("scroll",function(){var n,i;n=e,i=t,clearTimeout(n.tId),n.tId=setTimeout(function(){n.call(i)},500)})}(this)</script><script>(function(w,d, s, id) {w.webpushr=w.webpushr||function(){(w.webpushr.q=w.webpushr.q||[]).push(arguments)};var js, fjs = d.getElementsByTagName(s)[0];js = d.createElement(s); js.id = id;js.src = 'https://cdn.webpushr.com/app.min.js';fjs.parentNode.appendChild(js);}(window,document, 'script', 'webpushr-jssdk'));webpushr('init','BJrux_BJKMKcoDBNWov5dsd0zhl3p0eF00OUzgogE5bQRheUA7eytp5rcZXYHdodyiVfbOmMlAkf140zUrAPfv4');</script></body></html><!-- rebuild by neat -->